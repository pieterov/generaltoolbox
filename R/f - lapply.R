##############################################################################################
# NAME:         FUNCTION - LAPPLY
# AUTHOR:       Pieter Overdevest
##############################################################################################

        f_lapply <- function(

                l.input,

                f.input,

                mc.cores = NULL
        ) {


        ######################################################################################
        # TEST
        ######################################################################################

        # f_test <- function(df.temp) {
        #
        #         df.temp %>%
        #
        #                 slice(-1, -n()) %>%
        #
        #                 rbind(df.temp)
        # }

        # l.input <- df.test
        # f.input <- f_test
        # mc.cores <- 4

        ######################################################################################
        # ERROR CHECKS
        ######################################################################################

        if(!"list" %in% class(l.input)) {

                stop("Note, input to f_lapply - l.input - must be a list!")
        }


        if(class(f.input) != "function") {

                stop("Note, input to f_lapply - f.input - must be a function!")
        }


        if(!is.null(mc.cores)) {

                if(mc.cores > detectCores()) {

                        stop(paste0(

                                "Note, mc.cores (", mc.cores,

                                ") exceeds the number of cores in your system (",

                                detectCores(), ")!"
                        ))
                }
        }


        ######################################################################################
        # INITIALIZATION
        ######################################################################################

        ######################################################################################
        # PROCESS
        ######################################################################################

        if (!is.null(mc.cores)) {

                l.output <- mclapply(

                        X        = l.input,

                        FUN      = f.input,

                        mc.cores = mc.cores
                )


        } else {

                l.output <- lapply(

                        X        = l.input,

                        FUN      = f.input
                )
        }


        ######################################################################################
        # ERROR CHECK
        ######################################################################################


        ######################################################################################
        # RETURN
        ######################################################################################

        return(l.output)

        }

